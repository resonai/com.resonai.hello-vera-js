import{j as t}from"./jseApiHelper-af1e12bc.js";const C="com.resonai.navigation",p="com.resonai.sdk.sample.communication",I="Communication Demo",y="Sample Communication App",N="Пример коммуникационного приложения";let m,r;async function P(){m=await t.getAppConfig(),t.registerButtons({buttons:[{name:I,isRegistered:!0}]}),t.onBackEvent(()=>{const e=document.getElementById("back-clicked");e.style.display="block",setTimeout(()=>{e.style.display="none"},5e3)}),t.onMessage(async e=>{if(console.log(`${p} got 'onMessage' event with: ${e}`),e.action==="navigationSuccess"){const n=document.getElementById("dest-reached");n.style.display="block",setTimeout(()=>{n.style.display="none"},5e3)}t.tryOpen({activityId:"start"})}),t.loaded();const o=document.getElementById("app-title");o.textContent=y,t.onLanguage(e=>{o.textContent=e.lan==="ru"?N:y});let s=0;t.onCameraPose(()=>{s++,s%300===0&&console.log("Camera position: ",t.getCameraPose().translation)}),r=m.POI,r===void 0&&(document.getElementById("navigate-message-button").disabled=!0),document.getElementById("navigate-message-preview-button").addEventListener("click",()=>{c()}),document.getElementById("navigate-message-nopreview-button").addEventListener("click",()=>{c({skipPreview:!0})}),document.getElementById("navigate-message-noaccessibility-button").addEventListener("click",()=>{c({noAccessibility:!0})}),document.getElementById("navigate-message-dest-only-button").addEventListener("click",()=>{c({showDestinationOnly:!0})}),document.getElementById("native-message-button").addEventListener("click",A),document.getElementById("nearest-poi-button").addEventListener("click",B)}P();function c({skipPreview:o=!1,noAccessibility:s=!1,showDestinationOnly:e=!1}={}){const n={msg:"navigateTo",poi:r.key,skipPreview:o,hideAccessibilityPicker:s,showDestinationOnly:e,register:!0,packageName:p,actions:{navigationSuccess:!0,navigationCancelled:!0}};t.sendArmeMessage({packageName:C,data:n})}function A(){t.sendNativeMessage({data:{test:123}})}async function B(){const e=t.getCameraPose().translation,n={bool:{filter:[{range:{"ar:geometry.center_y":{gte:e[1]-2,lte:e[1]+2}}}]}},E={centerX:e[0],centerZ:e[2],hDistance:3},v=await t.querySemanticObjects({confKey:m._id,filter:n,geofilter:E}),l=Object.values(v);let d="None";if(l.length>0){const f=l.map(i=>{const a=i["ar:geometry"];return a?Math.hypot(a.center_x-e[0],a.center_y-e[1],a.center_z-e[2]):1/0}).reduce((i,a,k,b)=>a<b[i]?k:i,0);d=l[f].name}const g=document.getElementById("nearest-poi-name");g.textContent=d;const u=document.getElementById("nearest-poi-found");u.style.display="block",setTimeout(()=>{g.textContent="",u.style.display="none"},5e3)}
