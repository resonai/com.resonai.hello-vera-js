import{j as t}from"./jseApiHelper-9f2fb730.js";const I="com.resonai.navigation",p="com.resonai.sdk.sample.communication",N="Communication Demo",u="Sample Communication App",b="Пример коммуникационного приложения";let l,m;async function P(){l=await t.getAppConfig(),t.registerButtons({buttons:[{name:N,isRegistered:!0}]}),t.onBackEvent(()=>{const e=document.getElementById("back-clicked");e.style.display="block",setTimeout(()=>{e.style.display="none"},5e3)}),t.onMessage(async e=>{if(console.log(`${p} got 'onMessage' event with: ${e}`),e.action==="navigationSuccess"){const s=document.getElementById("dest-reached");s.style.display="block",setTimeout(()=>{s.style.display="none"},5e3)}t.tryOpen({activityId:"start"})}),t.loaded();const a=document.getElementById("app-title");a.textContent=u,t.onLanguage(e=>{a.textContent=e.lan==="ru"?b:u});let o=0;t.onCameraPose(()=>{o++,o%300===0&&console.log("Camera position: ",t.getCameraPose().translation)}),m=l.POI,m===void 0&&(document.getElementById("navigate-message-button").disabled=!0),document.getElementById("navigate-message-preview-button").addEventListener("click",()=>{y()}),document.getElementById("navigate-message-nopreview-button").addEventListener("click",()=>{y({skipPreview:!0})}),document.getElementById("native-message-button").addEventListener("click",_),document.getElementById("nearest-poi-button").addEventListener("click",A)}P();function y({skipPreview:a=!1}={}){const o={msg:"navigateTo",poi:m.key,skipPreview:a,register:!0,packageName:p,actions:{navigationSuccess:!0,navigationCancelled:!0}};t.sendArmeMessage({packageName:I,data:o})}function _(){t.sendNativeMessage({data:{test:123}})}async function A(){const e=t.getCameraPose().translation,s={bool:{filter:[{range:{"ar:geometry.center_y":{gte:e[1]-2,lte:e[1]+2}}}]}},E={centerX:e[0],centerZ:e[2],hDistance:3},v=await t.querySemanticObjects({confKey:l._id,filter:s,geofilter:E}),c=Object.values(v);let r="None";if(c.length>0){const f=c.map(i=>{const n=i["ar:geometry"];return n?Math.hypot(n.center_x-e[0],n.center_y-e[1],n.center_z-e[2]):1/0}).reduce((i,n,C,k)=>n<k[i]?C:i,0);r=c[f].name}const g=document.getElementById("nearest-poi-name");g.textContent=r;const d=document.getElementById("nearest-poi-found");d.style.display="block",setTimeout(()=>{g.textContent="",d.style.display="none"},5e3)}
