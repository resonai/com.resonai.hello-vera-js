import{j as t}from"./jseApiHelper-977d857f.js";const I="com.resonai.navigation",k="com.resonai.sdk.sample.communication",b="Communication Demo",y="Sample Communication App",P="Пример коммуникационного приложения";let r,m;async function B(){r=await t.getAppConfig(),t.registerButtons({buttons:[{name:b,isRegistered:!0}]}),t.onBackEvent(()=>{const e=document.getElementById("back-clicked");e.style.display="block",setTimeout(()=>{e.style.display="none"},5e3)}),t.onMessage(async e=>{if(console.log(`${k} got 'onMessage' event with: ${e}`),e.action==="navigationSuccess"){const a=document.getElementById("dest-reached");a.style.display="block",setTimeout(()=>{a.style.display="none"},5e3)}t.tryOpen({activityId:"start"})}),t.loaded();const n=document.getElementById("app-title");n.textContent=y,t.onLanguage(e=>{n.textContent=e.lan==="ru"?P:y});let o=0;t.onCameraPose(()=>{o++,o%300===0&&console.log("Camera position: ",t.getCameraPose().translation)}),m=r.POI,m===void 0&&(document.getElementById("navigate-message-button").disabled=!0),document.getElementById("navigate-message-preview-button").addEventListener("click",()=>{c()}),document.getElementById("navigate-message-nopreview-button").addEventListener("click",()=>{c({skipPreview:!0})}),document.getElementById("navigate-message-noaccessibility-button").addEventListener("click",()=>{c({noAccessibility:!0})}),document.getElementById("navigate-message-dest-only-button").addEventListener("click",()=>{c({showDestinationOnly:!0})}),document.getElementById("native-message-button").addEventListener("click",N),document.getElementById("nearest-poi-button").addEventListener("click",A),document.getElementById("take-photo").addEventListener("click",_),document.getElementById("take-qr-Code").addEventListener("click",h),document.getElementById("identify-user").addEventListener("click",T)}B();function c({skipPreview:n=!1,noAccessibility:o=!1,showDestinationOnly:e=!1}={}){const a={msg:"navigateTo",poi:m.key,skipPreview:n,hideAccessibilityPicker:o,showDestinationOnly:e,register:!0,packageName:k,actions:{navigationSuccess:!0,navigationCancelled:!0}};t.sendArmeMessage({packageName:I,data:a})}function N(){t.sendNativeMessage({data:{test:123}})}async function A(){const e=t.getCameraPose().translation,a={bool:{filter:[{range:{"ar:geometry.center_y":{gte:e[1]-2,lte:e[1]+2}}}]}},p={centerX:e[0],centerZ:e[2],hDistance:3},E=await t.querySemanticObjects({confKey:r._id,filter:a,geofilter:p}),l=Object.values(E);let d="None";if(l.length>0){const v=l.map(i=>{const s=i["ar:geometry"];return s?Math.hypot(s.center_x-e[0],s.center_y-e[1],s.center_z-e[2]):1/0}).reduce((i,s,f,C)=>s<C[i]?f:i,0);d=l[v].name}const g=document.getElementById("nearest-poi-name");g.textContent=d;const u=document.getElementById("nearest-poi-found");u.style.display="block",setTimeout(()=>{g.textContent="",u.style.display="none"},5e3)}async function _(){const n=await t.takePhoto("Taking photo");console.log("Result: ",n)}async function h(){const n=await t.takeQrCode("Taking QR code");console.log("Result: ",n)}async function T(){let n;try{n=await t.identifyUser("title","subtitle","cancel button")}catch{n="Cancelled"}console.log("Result: ",n)}
