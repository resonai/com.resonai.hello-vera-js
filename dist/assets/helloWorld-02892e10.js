import{j as o}from"./jseApiHelper-dd9c2ac4.js";let p,s,d,m=!1;async function v(){o.callArmeActivity(({activityId:c})=>{console.log("hello-vera-js callArmeActivity",c)}),o.closeArmeActivity(({activityId:c,isExitButtonClicked:a})=>{console.log("hello-vera-js closeArmeActivity",c,"isExitButtonClicked: ",a),y()}),o.loaded(),s=await o.getAppConfig(),p=new URL(document.location).searchParams.has("controlview"),p?(console.log("Control View App"),E(),document.getElementById("close-modal").addEventListener("click",y)):(document.getElementById("tools").remove(),document.getElementById("close-modal").remove());const e="helloWorldScene",n=s.Place,t=new Array(3).fill(s.Scale??1),l=s["Model URL"],i=await o.getSOCenter({key:n.key}),r=[{type:"ambient",intensity:.4,color:16777215},{type:"directional",intensity:.2,color:16772863,pos:[-8,8,-5]}];d={sceneID:e,id:n._id,position:i,scale:t,gltf:l,onEvent:({id:c,event:a})=>{a=="mouseUp"&&A()}},await o.initScene({sceneID:e,lightConfigs:r}),o.mesh(d)}v();function A(){console.log("openModal"),!m&&(o.tryOpen({activityId:"SOME ACTIVITY ID"}),document.getElementById("modal").style.display="block",m=!0)}function y(){console.log("closeModal"),m&&(o.tryClose(),document.getElementById("modal").style.display="none",m=!1)}async function E(){const e=document.getElementById("tools"),n=await f("Model URL","text",C),t=await f("Scale","number",b),l=await f("Place","text",void 0,h,!0);g(l,"Place","Show",w),e.append(n,t,l),g(e,void 0,"abort",S)}async function f(e,n,t,l,i){const r=document.createElement("div");r.append(`${e}:`);const c=document.createElement("input");n&&c.setAttribute("type",n),i&&c.setAttribute("readonly","");let a=s[e];return typeof a=="object"&&a!==null&&(a=await I(a.key)),c.setAttribute("value",a),l&&c.addEventListener("click",u=>l({parent:s,property:e,value:u.target.value})),t&&c.addEventListener("change",u=>t({parent:s,property:e,value:u.target.value})),r.appendChild(c),r}function g(e,n,t,l){const i=document.createElement("input");i.setAttribute("type","button"),i.setAttribute("value",t),i.addEventListener("click",r=>l({parent:s,property:n,value:r.target.value})),e.appendChild(i)}function C({parent:e,property:n,value:t}){console.log("onModelUrlChange",t),o.setPropertyInAppConfig({parent:e,property:n,value:t}),d.gltf=t,o.mesh(d)}function b({parent:e,property:n,value:t}){console.log("onScaleChange",t),o.setPropertyInAppConfig({parent:e,property:n,value:t}),d.scale=new Array(3).fill(t??1),o.mesh(d)}function h({parent:e,property:n,value:t}){var l,i;console.log("editPlace",t),o.editSO({key:(l=e[n])==null?void 0:l.key,parent:e,property:n,id:(i=e[n])==null?void 0:i.id})}function w({parent:e,property:n,value:t}){var i;const l=(i=e[n])==null?void 0:i.key;console.log("goToPlace",l,t),l&&(o.activeSO({}),o.activeSO({key:l}))}function S(){d&&o.destroyMesh(d),o.activeSO({}),o.abort()}async function I(e){return(await o.querySemanticObjects({confKey:s._id,fields:["id,type,name,key,argeometry{center_x,center_y,center_z}"]}))[e].name}
