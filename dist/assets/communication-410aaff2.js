import{j as t}from"./jseApiHelper-9f2fb730.js";const b="com.resonai.navigation",y="com.resonai.sdk.sample.communication",k="Communication Demo",u="Sample Communication App",v="Пример коммуникационного приложения";let l,m;async function N(){l=await t.getAppConfig(),t.registerButtons({buttons:[{name:k,isRegistered:!0}]}),t.onBackEvent(()=>{const e=document.getElementById("back-clicked");e.style.display="block",setTimeout(()=>{e.style.display="none"},5e3)}),t.onMessage(async e=>{if(console.log(`${y} got 'onMessage' event with: ${e}`),e.action==="navigationSuccess"){const a=document.getElementById("dest-reached");a.style.display="block",setTimeout(()=>{a.style.display="none"},5e3)}t.tryOpen({activityId:"start"})}),t.loaded();const o=document.getElementById("app-title");o.textContent=u,t.onLanguage(e=>{o.textContent=e.lan==="ru"?v:u});let i=0;t.onCameraPose(()=>{i++,i%300===0&&console.log("Camera position: ",t.getCameraPose().translation)}),m=l.POI,m===void 0&&(document.getElementById("navigate-message-button").disabled=!0,document.getElementById("nearest-poi-button").disabled=!0),document.getElementById("navigate-message-button").addEventListener("click",P),document.getElementById("native-message-button").addEventListener("click",_),document.getElementById("nearest-poi-button").addEventListener("click",A)}N();function P(){const o={msg:"navigateTo",poi:m.key,register:!0,packageName:y,actions:{navigationSuccess:!0}};t.sendArmeMessage({packageName:b,data:o})}function _(){t.sendNativeMessage({data:{test:123}})}async function A(){const e=t.getCameraPose().translation,a={bool:{filter:[{range:{"ar:geometry.center_y":{gte:e[1]-2,lte:e[1]+2}}}]}},p={centerX:e[0],centerZ:e[2],hDistance:3},E=await t.querySemanticObjects({confKey:l._id,filter:a,geofilter:p}),c=Object.values(E);let r="None";if(c.length>0){const f=c.map(s=>{const n=s["ar:geometry"];return n?Math.hypot(n.center_x-e[0],n.center_y-e[1],n.center_z-e[2]):1/0}).reduce((s,n,C,I)=>n<I[s]?C:s,0);r=c[f].name}const g=document.getElementById("nearest-poi-name");g.textContent=r;const d=document.getElementById("nearest-poi-found");d.style.display="block",setTimeout(()=>{g.textContent="",d.style.display="none"},5e3)}
